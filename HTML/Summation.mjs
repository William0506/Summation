const B = [1.000000000000000,0.500000000000000,0.166666666666667,0,-0.033333333333333,0,0.023809523809524,0,-0.033333333333335,0,0.075757575757318,0,-0.253113553152043,0,1.166666662389640,0,-7.092153737821930,0,54.976753316454680,0,-524.164584139144482,0,9111.662751133607158,0,210508.909183628280203,0,-3116770879.713541277917102,0,-8356739400075.568583488464355,0,-17283790901204699.320312500000000,0,-32101580623004587050.000000000000000,0,-56813802958301355462656.000000000000000,0,-116932567604099345188651008.000000000000000,0,-332888788359397722783376998400.000000000000000,0,-1051459120135248166599450330923008.000000000000000,0,-2763092739692482549329830290967756800.000000000000000,0,-4506445347008948113871608636877794443264.000000000000000,0,2853699170597587040521627926110288526442496.000000000000000,0,49474128233855075101993824763005651815059423232.000000000000000,0,133289010366872821921977274834357859468166136070144.000000000000000,0,-538424834898293747112348307773207278208318252643254272.000000000000000,0,-9226807356750666333453571726380692236804993900434868404224.000000000000000,0,-79437483278925076987408166042622958821193582961795836130885632.000000000000000,0,-623669899216191873243428405743133161812909913775512075586821423104.000000000000000,0,-5071567916162713163787531668246096443501867669445753976426368868548608.000000000000000,0,-41654610513031379893797942547044285481143577064278458764955028588926599168.000000000000000,0,-326269670206478239142656784991673553137652535802286686090762437561494349545472.000000000000000,0,-2406288356464750223809077891766228758461980292932892127693745292161628094481825792.000000000000000,0,-17591970012219628004889631603426577432716474343916145196332429194363057732436120043520.000000000000000,0,-138103800456031235561414119810972064722622544440466299725627771702455637596648330575740928.000000000000000,0,-1172248240822553064141302704438506520319665565206683437408072669531830575125635152793669992448.000000000000000,0,-10010791482433611641409270239027527600477277238154113020134571450580779434291874406877080504500224.000000000000000,0,-88168074673135666113506489400645327844394389607757335817920301926180655032991193690250068908807553024.000000000000000,0,-1052808956451489039211798194170615499733371525944697127661503470622097545653647740679761240217378885730304.000000000000000,0,-19192743921317494110464305990352156888737597513296333564613471515222525600168368106798439571519057144055857152.000000000000000,0,-396686391805557106603113453890357244198402916823381331050985463532140776278707787630627224145571182524109728776192.000000000000000,0,-7821983271803057017874517976690272064671165402852473860675705320646416555103894939407265812455902429246694292065353728.000000000000000,0,-145227569480938365259435003993780920622864591199675442725100396007525455021996323095344249733777965622387883298815461031936.000000000000000,0,-2577462697272184225873516659029200422641070866869300914181148558268500899107733818507805818894975904441477509796007905622753280.000000000000000,0,-43459350722160266664720558041490048276138366947204681447254830303025350636851349728555268189891360501073516827879131171634731286528.000000000000000,0,-669419877088484626550102787441738299429691398340197670956598261329180934687193266713524472680591688106125667440893078626045320729985024.000000000000000,0,-8596585671514948969739725975651232452605259515084881909171125913071250034657417808695864925148248515391747697424133413697533850733739245568.000000000000000,0,-66853862390955249343429681036357559682896085478186531039934971505433368281894048613963675198101897394760901236931230921221507327458008505516032.000000000000000,0,684465696260817020729573924238367399039686674705886960241213399435032214646595088836650760610802257449558338765924517807774090857668574078381850624.000000000000000,0,46721132840161223398045415492429611944063038186286605514577853163125604172058202293001624728805873429559022621740261744874019533824408360408249551290368.000000000000000,0,1372054692692454405244972934141038983541735917752424223262714212796273243220723644298852725236392746688130271268909106416914192592589670218894733286005800960.000000000000000,0,31697129327986778877765804211600657432442808749702018179139005561430781751976185985080205844610414023665190427191741101592260123827740289420299833589716001751040.000000000000000,0,654962677990453637486545578602051310989156431864666167517933644597693292813045369425191055350379902835550350430976335108893815379624540647649884604281980553661513728.000000000000000,0,12874112845598570684555180182524290472331684458831202840937765941479218494514243431906774280949290186785565419811622530801169154040936763499334898073622893520480595083264.000000000000000,0,242205211667024677350322850653308868471514631274130185597125851911486398520445199813376020685380313185119723983819108091898774265430284959666764207167381700020586119019102208.000000000000000,0,3905861465958466497408132403502306209097983634911782900130851651166395638805008473035487963209345188405431474814326343676507604222053437633900142445456437548424659128925051420672.000000000000000,0,26834707643327234295121372346937301474939736993957284841979953321900012777173859814720667087352444018989890710371819256970059513422305125755043264329622063497840147588654612132921344.000000000000000,0,-1739930087468794485745868473553685904247462635792512480015794525506508946522938235633651544673510621992542968893579122335035625331108629805386889344370919762436044122514802090582187442176.000000000000000,0,-120283620429922671264651772301246323817097000952574814763510700554295175077038196380699325470398718983674742980855051109924198255830536696334041222787544770728703693280937958257783635923959808.000000000000000,0,-5288108971692984007995979024346979652741622776603093018210273299931443881475497698003492960321920010886316259247413066364606206008312235423682208021754502813206473414951852861920627844321621573632.000000000000000,0,-198645918866488840289559040371080907924305978770604628265430497564806661867347757724377090957546286960558720296289465260016167489244861910871970817157619362952734448686083431478006346253289617109286912.000000000000000,0,-7005439786803291894693899000442585895701221679806750753795297051631174393415639548382274940692823749460351902879213011189792738019492655997535770039383369988460649592650182614466110542097474457363128778752.000000000000000,0,-244196110633342270426365893257658246712427978219035532494091485656916314295533457434100554294520113716159329523128932693230601978491775628899376394778973857812267283837185522819252933969295223971067060404879360.000000000000000,0,-8648195876125233185481700886518380090818475431795297659541113425626920934694799023654160219408300749053618571992593759100380807672694949457075850575185001248380897932367282460971311709069237222021083666969576603648.000000000000000,0,-313352464755383395285702062922628653280683040803088710691539321220374249730679489809594323325574037367884281778189450343386472092004937772600349157034748661624355501747082168809938422593531550576622711497289686335881216.000000000000000,0,-11537257835162415037222608126867421494999366758653375344356038496856438758846241475446987506028300058723463465284736566187845005031426822917242924462714687555375006811083470886605207663709367381932258458238145304833699086336.000000000000000,0,-426324307095029922342333634560089715824985643024515872433135807218715678384630463761077125270725777517155479223258998557105503433596619611251006507298408012198251521343897280376220381276038326355162339005231047511637612004638720.000000000000000,0,-15598560504448408118400872996430080495155314319311656183098246220230077733163184798023328327486494173746256754841455835197439025120628913895127435588485514717614347058483083458741430134180521086282438203445031714169435943600295772160.000000000000000,0,-557158738043258572547157353360094384289292909760434523164394591784631216561558719127815083640110723778989598500100063771472666289244614242779836619257195225046084328086313620712148615808237039371577394838620322825203490801080684578340864.000000000000000,0,-19112553683645563843196284292546854752841431060107986070273665537746088057991387005294879484489150050940301017630713830407549448979482172082192658857767373509551781437770846615042465303940447858335724659760187968122252221459924750923074633728.000000000000000,0,-616820028367355321912515270258086179238971591282192079244008183028844454972002809417599025989940536403257283826675625731355627833878567136980619417671242115484590187704447409644853088258090162692246361475152667378757673957422376261092647377043456.000000000000000,0,-18224786018170069000193320468719548838030122384031530685530160997204972228395314319817201649526309250364656546135017733362525374177721885718584590561415538263715397618771622486468793940137731046132294847750322317600388571801872173139527201641835003904.000000000000000,0,-476794439677917477115099519280962081040986666218217128815611276267113450463266365963103088983361234276805410068550956785339260554280911179915868070552491100371769610192535363004766260474641080673065669829922897987295886046534139800045299032804396560809984.000000000000000,0,-11036132692772061744641673067241061734992290572813486393343259029791881157830637292785052729159299635140791926887432968366881189244041841076574526707082586900804456858100740312707404235987245227578172962714730896504501690351523974919346225558870345996337938432.000000000000000,0,-307525937291325245232977182192021749934290822706411001364133918983252759831503679147434846137755999645254951941822983255610294744003685011995523335024565268444379374893931805730824131957593467603036280798641678233629774774028355063458817699641389427076278020734976.000000000000000,0,-20129572103814116900347428116697360774326722262888289251386647051787548146520262727692163956122675947565383448039833656862580600182826298922099733222680214769725326358694089693540271086225538402635149790686153816775854633004509364137264474351498852817564292173975781376.000000000000000,0,-1940301824286722859022382920945814457281729071461232397412889761682917362884660020158988965713168860305585084773275599284238932281256002671825085998492956969745056325761876939464769278626473360931495416255044772646010765238475262444065817946448408895478642540986886155927552.000000000000000,0,-170601704965160067427112616916968568149802337334781050385765221527505528103520152074134071861856928482359245567116214863198782802277543163566604533480804610474799424623432228999961915475145526500256284529789062837777751479807750915338297957412670472033569539516394575072583483392.000000000000000,0,-13144160141427788124146621667677993053813885020026071920144253812504597467422456778455276340693325614148058008457329756834162057907449856064455363014917674657869964393603432260294739597600912684376702282530439862182310343424830502084641723035538436184822711041240904148574015082987520.000000000000000,0,-913162200817620542921489163645236487794809805964066220878168858077303728435536523231122553645255027740036228282592551646942728549697044278520370918473649340432046610483056118950592638636886522559534459300795592929426389556433054318658174932999084816186429066537868267565691112195545366528.000000000000000,0,-58591729126979815242617023512643139628535044958453785312362386506938100517743837202599485349511532022304326825458784962909255317249904766319623343904589847756329208274026886041809364079668144756177174889887408105897532353701446564395878788621411400164014145588937433590709168822423697615749120.000000000000000,0,-3524870152708082556664444441393248285194987942088258181341014576400494052796723214350675118470199337371178691130629494492442955970101470116695371671866339872511935737202053876729256978554583919699780060824622817270670554421123696239243551233987182662206754402791508684978353193378948235362054438912.000000000000000,0,-200455137335128450278330423252318322180893122916702678773720110390107619624156808832278651945144517907217551881747111001940919144414436068462410808575941351265423490236808490521059785296374765587357423150004339622884595603766913357079912517829487318961628325583964214643782813862640461862664937282732032.000000000000000,0,-10796842559947809640138529140005223366053522700238692657690223665062926426717948843007095232980524111459126759328419132615166570018975437954182383198941539050781443074418455660039744770406063449215543676939360319429046589517472373768033079134204240522358970243411681963853483697518189102341787937210061815808.000000000000000,0,-547342455189054591951418639223508829660776236310033872133044176050874290018327630577049685123818864131584932312233556239727080420793001843481563685087647032256333658152536400667624252532596897814281133115657021477384265841400619119638477322413593431264898870978366043663188980064556360887079373327782744223121408.000000000000000,0,-25558539138428644794429765882198820808610169039873114388422566068566588837186863217732713573530586905275465737508342434999074331506992229139037017284367677603613490639273697116244217905809652344399568667196888292215432440347850325810734793532393767082095310801256221459375463584419123021081982032046584094635128258560.000000000000000,0,-1034362040626297696913042005867784050368900776041711147602045078453786397789486466394572753596838954166777585870956201615706648212551612097050539780240682347915607496405347520089249074313232168611190294946219210061564025843216051753655799731025697796106962498391153116598986166448671500468918041183369353581764141605978112.000000000000000,0,-28840584274027913124033758341151877695789625727650702878137381698875842118165679869190743136030211429837879907621422269450124632772444007576625775799455106058429158382411132131097806804105373207405720904702470246714671925468073572908598793089044566862326838260801625726504527453678031707610938964654985341611874721284904452096.000000000000000,0,432575712297598960042887357456101666803080803336065649717617634603259714185137931036469519792751724595474073537276590396083103554069105769135847098932062285671902298594265919205240890756339712178975828839156239004194085196505423191092939920406585538276743206569228068366743586901924016449795534741554967041782381120572798135173120.000000000000000,0,163188714177345146077026104687259541283491949690489035072077919500052047045729389906254081938909979415124971801011615496644082539471058112025406650146937843641309372159557992285513592686378026919337340758721174943969289435877007506556938148455531724918400573425338769197670711910213284531014272492430077510311142006001984031358091001856.000000000000000,0,18192818293558698891038018099422962693443222082470412731581887903379344367350060034564346901495378766782884775754407651719943071469975560741849968544016289912489171363417341772853263623007152867203335216277328279954137880023488026107484704407323235961948264142703014179700506619533486461344673110512534697354209625416145625318081940554776576.000000000000000,0,1582409263104583297124167573570716307069546439807370290530629872010229264193536010949226843261291243056424856214908024809155438502063558729815978025529824670601830070727856073983867463964664102431560074757568538444705652081623341093370111466149290033849865907977971032031968051676770781083362996839320011630587667662025570107538425526614453387264.000000000000000,0,122136136073801133422921121043631406274690667400715547717338602260563317758901908345616211787401203860198288799010255726431397315742650605233175526466559847824123388723856220627154031002194781000895597382023980197908802361672815132651514171535398693123473758496907667061616849845627057459695629584327800774493931664482380600195487484448617926712360960.000000000000000,0,8775544505111399300138212846233898386996329673800195638664229573130075609215865510500544358377402689192990574286168018738996756044685441631370034020325558415144411393400107782819212832466679157988581399635095272902220816752927224289748252024602442955402557006141071863055155754324393867826453756915745635192985451533096216850035975772742005794980642160640.000000000000000,0,606196735943894620172615772284038280100524393252594397238025269557738378232770005376238209320657055615443472603319260426925983018744582370648759946273624503215572970506732709124440337518183414171950071449312423986746894580050139822514387784985482312638941652055477241677202193190551956523683358871755162477484619320022717858062800026553989032166809149586276352.000000000000000,0,41766001480496684551485469583132978740170162637716306895880585873571329473742204579211280467162128081345000490595651553210214559061800821080771136388362572701881063132663266327852038476437614712421895203053611225615079277828587342977805207610649796712554370084019810401438764301849183542183098495655679706159101688399750912217333857942399470133640738142958701772800.000000000000000,0,3012360658052693364415098981175641555468255684188049389548399834672629126313017855682646732609143751744708596744125802391058201649756100866634376354035328909308986782250261824938317373303619454966910494610630564652594010417976664576033082919249198400628169005594824557956302046279144506505985692105996808347296005380456818300653587642721531961746975491514811187910934528.000000000000000,0,238505214087300234945745140826696343850427118297380489490973697868671227129282488076626052797087861289700747248375652909202021790894076144894446691989727711907021416192760569321338102145806879364201464941273491061468928491333901923651468011095014870659327177401595791270037728818647125505230863520678292451259455256268394813706019050210442954753431982816735275420517473976320.000000000000000,0,21044891442991385822664972278936603629156686945627239995107254654946653352499719347778064625169800215906323136156952211316817586801128360209146206552711903868970577764255914077763886955217261086767186417496251081162617791100725546340145155679631747288596186015299419962179559836279090463296056503660739051736549172616001866360224853627732471720083336922699598962299773370360659968.000000000000000,0,2008472633479410306458315458247610138573367210365888487140421387617206592080970427713383666119011240031855260991913049620849888007908748044207362768791237832929345813239288421123232659136628849708937621021804064285754028583302336089513884205848301746714285643893259374692604343599562101420455162616046923436885107903883179211811849133862459496049937610201504977865442592991494386221056.000000000000000,0,197564151130097281281513980280854685689949704567881010966160031443979024622075844868504174456510565280694288139602729772122051702430478203011760098758281109144356451826097155640337991663421049516754654544602602141411242784371892378797359012793000805709517577328536472808958078966131957024606649545701394777333122025268105680714536560486280086524033206746533705479290639149927195985743708160.000000000000000,0,19269528774939334813935091925427269807158957402940445580328527488226500699346567340978900964887078314704822377014432195790302412290301977619112506339220936310465842035631648624614003628838703415303991837407181273357698035199447490737825742025633914223377637410143069535447856056926112353554575048921434148624081455532987907100652474030853126417039520795249768547946552686923935246419066169065472.000000000000000,0,1821299473986847300693685682346310401444336500273577490540498147508030983471921383707276159696687144811719918265634557981011968256525355854832757758935412492586604301198571568498244973722333423806686570374676543099623633910264339774835932709710941539183831882908021315821682807849684331643689700927659915555614525709645655839000274464357676209431546661044761918991659238727762265613781582614299148288.000000000000000,0,164817525069130043090449153603167774498015474251198192629687770647932842268734857842178940484599805641835123816460358743534350105310974807929764897931258052622291338195750383591242593570467361281615151002021543984993140448945625398498382461023903820444418414587721688257608446477975706012542543027040273424272573615351567253934586240301786622341696226477687159770816333937505382336303399768122688026968064.000000000000000,0,14189825978011274890094389490866841487371797660505069613525022207129310099733928644905465339813747598819990695371373108304794904037837566551741862247015500334457662713214135507046666011571727619557728172170174070487289441819545808238689802194272369828471777515833349162188117023667822504465699729589793485203858565196629204903358068763833171693341755978619976538149802012484237638478013904459241656235549786112.000000000000000,0,1158077460733118982526089085196552037193740087530656263897686177850123186784573966108898688342062744381042875050667145288716967911195308592712269644929614500744362706825059514767970871900033966808215158169387272492312756431134821440987299301669475862180030993818037599866480637008149960730383784341596123132846991803020824398030731538173865238311704960412807234163574177941798100092754157264923223277087816683618304.000000000000000,0,89451684884532456135026981951354118262921968753215166987057812482980937857831416941118482224282606029097871113066413236369259172284425080606773194862729561276406004967992541632683440765141937710477197369757346055662892849101897210000289991985361478160659783680634949298936695309639919419264332735241224679231614305317478631588970048944362644235599086159976740974321090871571302553552408425396345868569361535370480582656.000000000000000,0,6553718203763738704698787010626062025928317842726711214198987138598454831435152156503834061917374109503571790846873380088771285450306035440945948745370305840338313701754568672451964822779546280627969218062714500171362310940181773831414689120426942113025566868824242382207279899546371742434999920326976961650540792892197564434419952606452765882977685548847815901698810435036128122828350553194409938926986564921944885411446784.000000000000000,0,461233994657995785290997674304676751055590670045375519364608956836669610212057650729869155331322817426158131349916996358667457240663577833814253079099028148134612994873056966693111247388139206272779164793403699010556096697245600354056564561847685019756048792229476988443306744691722554947790433125295125770331235772330595410508148644160060243192802378519791522714767769033976885154564538595290299563150600694986244696904310980608.000000000000000,0,32416831330125563881304671485775363091549932260712618873207184712189258476174664764576646680544949881190024854916323689183670077451472043317815349536849504321927887880321626693743655014435561034803107835304275461848255304876813449726033340810859146271234429945428193270414311895761614209595079193328626011019436806432014230346502006217156368495068300771616004766016739776591876946297547485673574401032615223121381603754326452439351296.000000000000000,0,2479423794860842185683851382956804275177244261113274308468999092553476875277711236082790425168534481703803575746031758260830818657432496754376111517385979732277252899623538320569748509246813978678351008441932642357273080739710937006576828740462247133006807239942706971087641977286121449094324272848484889311498536751358919977537442858172370866350104672681566189101676056364329756887014666997392021200605851110268166232986891612862891950080.000000000000000,0,230016095118218678819774754025454060537453339620528189056437661096656889310616780495543135518507995154166944478607723480993638956955955855702826367632310942257111642747689362201781842016442526268996772525804254217563385174691708889869420491332800465061555106266032650242324885147680405426264211151847097057770849565788824857497811749401243574053543100934415085306254569770502899278224114754234693500866487109988420136103327360081849214140678144.000000000000000,0,26459815307354430620838987851395091380541697808250837611984443997029461680857598676699763363379508729241768874393994405846970488304134692726281346777603457874430072725293545814953349133848606439895614622870158716780365114178501458363025782410044459515491720098771745534062280000664726194937805906933129265147520778113231469610882464785492772278212280619098931835725901068734155049908248215165860987437761904884696638501528371874302836636730219560960.000000000000000,0,3460998703722873997311344485592200635441450524625351969773717253228203321588228318652606312024708055726791551361937977426352694422255460946833969907127770671199108381744835253238906314465737560109352199720030491371537144284758223770155757551847043614575840379942569061845714194302707098705960782190552670218560676455426565082976396007667076550353467081267274664608784441961382369908855562250955954447915012026935564763749417384575362327097874245203525632.000000000000000,0,472508109265476057995574819781998984987889516493479262165774469076927696269008828331140699290021529840901476708985904888253336642736003945609718406894313894707427119595352421617250713325727239739141534276135155072228201470394263279343069195528964038984124574612797066350690755251232592365352533984714049354414697080760151887278560396698404305013678973409122127413540087421176864928549410099665649627125533856593961861736750224215787413401737641303229362864128.000000000000000,0,64847892087833861211631373674528566827586865644265098550329668424139575941417349282628658906236194505746039615901056345547676913932607116230405842024220255862199022907903958894603716279336830493732721520337212853774911130401069729784137261097403680562750612330307004749442949763436603714868125492191048645550615484592092363798779976802988613817148465176530569030864730385764068190032377135897653419507304778759078164142365552672870975853009721506750854487856906240.000000000000000,0,8882314258914242370168425878957790389544003725893161020928431981639100307111729716871197205314048126788994217856729304650013682116331055155193499662176528224587237293916729297694338956483249854300716892778412015934963501975129874769047456874131015711670233919384687450168388389436049447055944218273122644599404565779981573389194778622438635996818845656794434103529048657714027999899518570554453451642471213451869862341475250857705530677409871538979987519370497890451456.000000000000000,0,1218527810415193935028446445203200537612862609284919594845118350921904707458226049367943608034851658009255512464227412809191404000901386552193619816080866191049794379742933007500418384460182358358342548799184153527091299513163278911816220344135913152349008624054180178811810277574971530999992213716847485014389138602498724481737358825444807760687520903787712997924569393185908387140950109191555909096401174305340771868749909014250185203872138123871642573097664221513108160512.000000000000000,0,168213581578771098856286817442517970959264281625472939539018171252088184675304236110891320112277137643653100195751673043011929705736278063886541351345184476282784350276249319292932005115126534078752502498239972731965664438192980876031391005278824359426370017050942352064446608200917334723771569497827035763524893491008276179839219943172486357467210194932711025452255839541968154955575770863905673629222282076022367218516111216695193356340969107828725163977504698155246647643209728.000000000000000,0,23422185460093047136744096072109721034750974717857346461943591149013865174026556593693821535377666569052564441143979937931274716183119404771928103414630041887141945121316020656847145905234880403747199417329556443685809408124791652464311397816832341634312737492417277432649833539821275405428448031468217252786142452102112495153459433637637754362980229842733086976841445030723051330166741624343050002964781984421789417638694312378971691438085915029306947893356410139876138278746731839488.000000000000000,0,3288181583327656119157519943575555191562822151278835996016729087341701442376902812473449836698015323467073430341868358976045004078919586341543500194450639506075641560250255514139746682777550263827625681843558924253113390478936665773120809789910512865993696002412728419155645866565024038651544721638751953125223534736845482472680016557216412166601974460193887322144665254049239318874080674054005689153995948502250743096065588272402960658780819812309089224265421034624219974485606797318029312.000000000000000,0,464379952395219162481447235665116365172419883573919574118200559065081523181290189313909081994453916189624524966049529544165846897271295072879005670102776957022287910379849475629794714517795165393983206022735397380950684437059964894672462191483925497424714428690377547928399238305009214696061324146917440532154158776988494270170224051043991804104857542123752901536438320061724328569534708417073135217777982656863020116054494047455738457974368507848186088996358605182581110417737112017807633022976.000000000000000,0,65791872915537194062618483996276760318591363434624819670545833300268522990715327311021469782113366560568309128535328707445647348640951835189406385997804563722144936144459170734980881702878199751206558470149023173512914435170022071923453700219608554918092392058679634417107840484452175193242298933843433623528936233126646478984695914470824494202016931967759433512235021724862045056848621078875559437610181440387362282183956907497280678517435606357421554250503603606788833657346977034441512329605545984.000000000000000,0,9329670267551687174696619467193763308286875987911035456752605603258678559413908103158375581310930435206785336410853880568201222743757301025841373920657745023217520178781347619742590302228476659518621130744585761022019757753598823485062564493681941721169935582495608958037304501577487109685264602028632884309295029290275949718011917493822577900558429811507240273517841290143524511089157933036908065564904239461063728458863985703736830344423088868333225386430687152090789423457779706634573887993262041464832.000000000000000,0,1322709623903088053194964055132618704794207896500449097091394046833522149261642328213038919461449445763346917173436994467588453300764218495449840004120584086788431829055171932234592358274356945353860409320409286869068759774268652758451450470932357946101284219819191233008196452852168836881115637260808420486643491816248625343109459842315128068565210572690793061357659288452343765514299068777441625452452910839330269882437565725993243621976759755208618922700357168254732843397214297380321389260913598570472407040.000000000000000,0,187526424815743669698549281111160225594235916632192858990916937330810882835782476218364460183848647921185926388664865100515406269747306930790362976329712590924630165801064473583172704113175170750985193100217021184109383673485966868122089820646909303516311958087490224433735478834351855016807801526548911492742436583160760584408534398709655923064533270954915206419806361711477185318548752684580238160227217323344623737850573018305211997622386950315550717342689229366085316582675717147067252230411810353988954723713024.000000000000000,0,26624184305558887811009792876603675961440970829992649992472990354746243633722879617417680544230888634716605443191429616732433610395636951335650866442849345979688015118720024167434463575803673711366333905573184013673711623154273600189948466339442147842451444358961473758403493350602110632526894209958166418112731232653858030549333911018457516431123509118998547536848026167037714904663087133853334212906421350995360659449675619640488811857693941193224798972215149121618728320553588591719915185054990598164686071542885384192.000000000000000,0,3793438509729625578035789201168998796857998333532882015187564532947210381551339070957068216228303475846820878601527234900363412227748267464213290512999227254697463548356395482433027486506855229495202114247215872869344040577446369611309277651747071831709430828430778779859257793905294631419887208863105887356400069208515090101501532269955622017419256486994319659508386783571682672527737477215068219324110664390483050652123535023586227407304929788131314668992358157564481113615207496593966373090494031761929418437118529625915392.000000000000000,0,543552139836923226119190895252525591207799766293471351309719217980428333695367119210221187528493102591426757362796221088118938510095374705654772724306529508406673799460863677556254574393308128369400815306613292541663937858877728784657200070435009302796381323768881049434833578725534297505481467740064566591578858287365989146957020566166372368803877554436949581067780202597536105984028995156760930386950258809648368468535437447180447308812166065420152541566069507229286957848692562451475192431009312579434923090375646228278323183616.000000000000000,0,78416658151038715429317324270933366249254187798081651802740869569043222639653128347253558575295773151976847198934503380444491984782923142572320787968915619038680032180016415213396033690623442840419040512233119821090366459311467540745065247701041260840045971893275082456184700003678062350167648097788519522609586607802771576790314433934380400421786860785363546347395863132647661216088011606626456823519991033303274644395357573331838416281808754593872774808652410162032198003389554933456628426557238175110095399726516251986480768235864064.000000000000000,0,11384688629058606125635433160140159122063062540633022124606060455023496393128946146867611156185702370169582934407460362125983983977381302534655421988458005921745920221419828960867631685429716691072105350396909819551075845685821898241083091024195622987168841764690429159344170503911144354601348615970573878608104748830972206756586917329260886834502706491980942138632333330112447019982283774985538407642242641576292119989387731681631282045402618707150887622459615114995242645248696260815282924538248921892922600743405342729230486653058227896320.000000000000000,0,1659220783602087160138000989801102597446956383708226453857824916615142035770183318966951729486820214178160346816156290849125927419988774802336946944668434073355906100705806032898346262566889556477456025979708866842408892778989318227129638283248107451041404212619743226535999347676635541545266138295102805780461297843178159893660449336303955527369292728372242811141865388775040987446580980312839370612153665892883573757205099883097302585669675810595543956802634916076285263587149483454724411361143358917992172516483053765522089139829489717779365888.000000000000000,0,241709619317331794592273276362023574099479873082401871049848975938864311599077250751996927955708712312155398208276142635322791817359602943411981351823783539991127701097478016759680231041583642729714662811080232801041912939047323228483694691066041754393297170868113391123118735623264355407600275623692890774084879412401663072854858827451203158639837477267615567496086653337577651837166315768471998320088372210251714839912485072759119610210612899965417968117489578997259837405841964485163899129607030734898849708889344122433633776088778343015865829556224.000000000000000,0,34998898123435107759821722216502349445497482716214329279671463636201781001481443138883837635322874502911886724727044517700984811325860757526429923077122365765870025385336589737160605111916576497364776769445445307406305520466863050360723234353025232771728977008882494676113883552092102660182110049796455200526394099873837520100782954300400490144563965815283517279964316618031074400427803538546250233530197392476066481478743402756602642591281042910059045885664779832386112082686627905093009719270312743724693967321951658485722910083290864668503922966980984832.000000000000000,0,5004845306790776443255107935636984433617410143835138744124013509860420399452563998112007477473395240335888165735786925827587655114286422714886619604669255021464302641508299872301900137968464278832951000059738515777850607928833143660912479699668808938925919434898837695786710673677294219093014871228913779471516329537694542318048088240501466053639886031676945305182108835850938053801326132169697199027526611060488390807752146247744759526134695710198592974088285884399697322681067459291963223455911034798987143605479311134986296309104887755828634248667206418169856.000000000000000,0,701813871590725584200435499921107374628913371614065550670658894306879030020327950697768154614085717044873987978190568563736393019943298878046599181684054475006067229410917747626518570101741437003559913607869830245823915209823571072214449003086964266295859258522156986644018263518285672612361994818080220034631490785932751094181742199092984798464128897947440711938864036781172417306588896063420671535396943920760034280102480440354257530836447623408958360651293768762609836209176418054396403585217226575447765688277391025502716985800581593399953752970369990814964121600.000000000000000,0,95719132511870000293358116581731565966174441123430543768774642257362935799605776781503789123281040564480555701172789915316159489305758677557177189445320508904788575877153800017937275353866388954070133735303795872925928794762271874964808882347878857194394162250568450174060421679526664485992647608985785438735622551404087302977829853180670071308707959325767027896853961060153386480027426304483719993176579657874225616341416214600618353421138882864120442044251294480639867585198876115799838256193299533786907222356271915959284278643026533134093207063189935982018239605506048.000000000000000,0,12563526751421067433482899009430686059935217856637441785983904850647535431444408965656303857249548852213757351999882523809206838171538880413244299522706608625861009669510285990295527026774591085356711150937460863931331535457379923861112439070086506402648968606008671925436972535249675382533892539859146482850277524659629280397897364406830822201894514727041025516689305494882503724714775176475114709961366768306617848927080190704723319842886003585353605883509793766655482659319251335895867977754256125739099430890197414449778877228497535112716690110945479742933928082283893358592.000000000000000,0,1561325178426749133328033775271146429285413670369097487799569680595524000155338385432823108657546105206560333961611149214615967670320813772020771558143271772897383032878124185749443303688377717987031925642385764715892842570282630710650876693515429189099499614109476469001983636706104666780857252216490600305482885290016311132211117194622524023079569499269682982089892783154877380998272379862949484040553069767984883079829284742674033214965715396851293468005647103141278406020331264590772907825923833980254046425627348176371348077928915406740929967404939695599639333043646326361817088.000000000000000,0,178267118636810613007099503069878646619171706649673534965255106728291426390503723481581345632076565216887360085105787168666327785390780684931089727476481931042859720845187854097785730779244429370678020998935395089053143199141978867532990915653762203764851050255374850862423135935187528995393605661149306144369533643701249782872785133430008348206134617144291558133844975278375047475561292024363663217071505458423565763842831610217257327304505508028031131768391970505784352781579039487049625652525026007839761370016120624287590406058190693471750113016682335984385948496824545594921581543424.000000000000000,0,17424137403040406104935058178439561725124677656383501008222821975764920496488871554091185950369526647228927102339939845650041869299012894360879351507490689654492610989969143788898189183575863226889200510897787987848416318909914927103594559240567269280638389220923598802415914326007806681774677346828528447252292528227742270376900918498117465218760057921575200941826819863056682004713946556801931407326067762461734486442103421303049304334919992476186230340638058709543487306379604622791394400860382923715120006105869946454685239536835776893920379448436289992025992175088978707502521242236223488.000000000000000,0,1122395654667715517559981370073518612355891404754322531435900716932041494610279673342363013855809504325476135703136564849989211337319648327989126310204131070757680944218184510867812578540917975522375839955961650427612467432359538926828262788538270753903523151897327814681841511367508074044634277772803116235266722434967115593023211382063550923629393766608081484954275615636634021780537089384339429928545324672450743804645535920911250246707095251547122677432023031351892416615667531068956654789069725650886927856027307876993172187121684470327126962556835791605977370928965235563985718181972909490176.000000000000000,0,-59138854220647779694497429449726910425123101463380551577925166815021115962424855598387466198269932042252705542451253196942706013929688442846638654368763704540205286686981791176120281635506878257534902498927235559275374390651925523275248711592315559382351339511492859488005336308258845182735126331062055734938633885449106076447959756112005741865498428257012937365060310757346013750978904840003886296103346526639823231214921787151066695261116300931195183652072625344528711637065202774279330767052403498065782373383662882960200769878942154135433697504260209401712764315679811819665118855475782145319895040.000000000000000,0,-41222976827144114341808144225274027809105095809265957740074077727892751213377105437847956223843984132901213276023687332201851551809045805276331578811968833855744953028811078175838846641767498956898978619229584081947428271700221607281291381212480748463632260409539796715016186973509389253101857108266645761188346180989243994060002796623114965992462787792071242278854403417848663780779743823593459310296577866059506402147429612363877750811698044620675553636164998838313453072714376593882363596134732812211781436220422095803352214830846792069079548928877268590297785229014975207017923502718632827210280007106560.000000000000000,0,-10237400720025649544528103025074844198230600722446386618242539278388574796276023276061834674291284208325661077397014411740374510784566608748015719437648389122331387190473027110698849085116118426703526572504366667596597682661294041475022512277120368698162062489199958467912726095524788984315362698178703313576432639126739120772363137524953673634443873426170547574780729985424560757594140105534837465424643030632853308922901638868976820125109234677624002281061262956131208223460576180294603119575446468704473093548319302158031303572159127036196277442695150866376025950375226820403768205171497042084802280429388300288.000000000000000,0,-1905699477946304663012326952394658029006442324495369250259495938507029572859009161506495682747797729684497592899348274136742059272317087463713443004254581118096204484370211115295661272035091506594264206301800401823202893003851875728803253300296315101594219157829053937708046085763119942489478317373358497732384108376693556471307324528311200709499924324387316095826545932101779474355370803692385209865238795495553212125908974367861748361532766071307002664798261263689385210818181037258968138618469492597345934059788022187704819922834004616591403080524848715669921913112329625326594379741616316706745863536992379920711680.000000000000000,0,-280478315648812560184558009885076077242226144746470043196285055329754637504566823179053047748768018457733132942064593245086924047432196120451223386441165231658206958616581646420786909654073053991585558752325002063147655577008508513058835702292792698969490515087672899112742614365907804974827338044688816784216278463613145149728683301792541600169474739184168426214514556235833319569794701495840841690222754417393470071001684338451785645355876957010892817633497203413424381500226873323893634549779447727882870448167275071297701989002856193108052793682416214071167604039903434275104696006773763163286969184565762769154511732736.000000000000000,0,-27011851241458880215270198145443641909033788236783370169825720371377980824900666048505966640559289198931871243412030497927659098536140217659940831402469660092203472349498680428446076600047185364268208540968455268017559099201740817355251282961101615419642047553401260471143249728534375864830129268215176879971039973969493745849807299667046865473644126590356088585167220702418352273172698393252044354415633141586892328115878967295723252646431101603598290869143227885613301171759059010335700796940941350554565255350003349183248423190628597870895213319629155373339757386778463850665314818441222617862002371758625725702536472131796992.000000000000000,0,1332449345962054410350347603178735261274179344718045912226691672991520260933990893947583097637962870958505075675504344041258854950499371235685251535595150118419512022750099985025399948575490260607273030392288314333460188223940232101670122184728133557334991894494838470297631241759595686192263278584486876089320821096745629498789762807653029318504019543344313979377230387109502450953372824296059147521634042337911444114430636051315955719820534375281817932622915212504675839136196361012904616693292350317582134103249262574836351446458696172693763188799275924573374466729354681234636736716729092681177837472007678880384715341358356758528.000000000000000,0,1655773072718947046927961443028678564590866787097367528913153417469395193760288730276319114531969423547534968854104549023248618820430515473626880301264679734978082447981980082778162698108345163494348325822235518551802601717443414317425415852811487884495067822167392328353969673283320741995677148973895870811589691254231403446695734192723160564241783478705964324112661621578280750613131297425180826416853372827825535723200128914241522371599748261582789261326078529790711784107822027026418137510492839653178493247563589775449663629458452916861345549838831514663817647123017295225257690948371623409466465182672664401457446696569396962338537472.000000000000000,0,594395112469431625364318635541958143793502796005842514115587150566442124188031091647574777635686904672606946372533771297965299525135456916753275293396769368532433402936343414742717662017079831902885877551685444859159175678059598780161553384770902234700549088813798884429483559186767239603908588805703800172367547063661375784834689177251744759928866811901798000326455616814769215998569574720067301278640483498597302060211191407491528893353395412004667112914904537698788407240970395809781553763346880064517029595695249954750064542817309141454967493376397567786077322491203657097720405666421432919491889982527277992446357289911862465722413706379264.000000000000000];
function factorial(n) {
    if (n === 0 || n === 1) return 1;
    return n * factorial(n - 1);
}
function range(start, end) {
    var l = end - start;
    var a = new Array(l);
    for (var i = 0; i < l; i++) a[i] = start + i;
    return a;
}
function sum(a) {
    return a.reduce((acc, val) => acc + val, 0);
}
function binom(n, k) {
    k = n - k < k ? n - k : k;
    var a = new Array(k + 1).fill(0);
    a[0] = 1;
    for (var i = 0; i < n; i++) {
        for (var j = k; j >= 1; j--) a[j] += a[j - 1];
    }
    return a[k];
}
function sign(k) {
    return (k % 2) ? -1 : 1;
}
const EULER_MASCHERONI = 0.57721566490153286060651209008240243104215933593992;
function zeta(s, t) {
    t = t || 100;
    return (1 / (1 - Math.pow(2, 1 - s))) * 
        sum(range(0, t).map(n => 
            (1 / Math.pow(2, n + 1)) * sum(range(0, n + 1).map(k => 
                sign(k) * binom(n, k) / Math.pow(k + 1, s)
            ))
        ));
}
function mod(a) {
    return (a%1+1)%1;
}
function isValidNumber(str) {
    return /^-?\d*\.?\d+$/.test(str.trim());
}
function isNonNegativeInteger(str) {
    return /^\d+$/.test(str.trim());
}

function calculate() {
    try {
        const n = parseFloat(document.getElementById('n').value);
        if (isNaN(n)) {
            throw new Error("Error: Invalid upper bound");
        }
        const cdexInput = document.getElementById('cdex').value.trim();
        if (cdexInput === '') {
            document.getElementById('cdex').value = n >= 0 ? '0,0,0' : '1,0,0';
        }
        let [cx, dx, ex] = document.getElementById('cdex').value.split(',').map(x => {
            if (x.trim() === '') return 0;
            const num = parseInt(x);
            if (isNaN(num) || num < 0) {
                throw new Error("Error: Field numbers must be non-negative integers");
            }
            return num;
        });
        if (n < 0 && cx === 0 && dx === 0 && ex === 0 ) {
            cx = 1;
            dx = 0;
            ex = 0;
            document.getElementById('cdex').value = '1,0,0';
        }
        const kInput = document.getElementById('k').value.trim();
        if (!kInput) {
            throw new Error("Error: Power cannot be empty");
        }
        if (kInput.startsWith(',')) {
            throw new Error("Error: The first component of power cannot be empty");
        }
        let normalizedInput = kInput;
        while (normalizedInput.includes(',,')) {
            normalizedInput = normalizedInput.replace(',,', ',0,');
        }
        if (normalizedInput.endsWith(',')) {
            normalizedInput += '0';
        }
        let k = normalizedInput.split(',').map((val, index) => {
            const trimmedVal = val.trim();
            if (trimmedVal === '') {
                if (index === 0) {
                    throw new Error("Error: The first component of power cannot be empty");
                }
                return 0;
            }
            const num = Number(trimmedVal);
            if (!isFinite(num) || isNaN(num)) {
                throw new Error(`Error: Power component '${trimmedVal}' at position ${index + 1} is not a valid real number`);
            }
            return num;
        });
        const g = cx + dx + ex;
        const requiredLength = Math.pow(2, g);
        if (k.length > requiredLength) {
            k = k.slice(0, requiredLength);
        } else if (k.length < requiredLength) {
            k = [...k, ...new Array(requiredLength - k.length).fill(0)];
        }
        document.getElementById('k').value = k.join(',');
        const l = parseInt(document.getElementById('l').value);
        if (isNaN(l) || l < 1 || l > 300) {
            throw new Error("Error: Precision must be between 1 and 300");
        }
        let r2 = new Array(Math.pow(2, g)).fill(0);
        let d0 = new Array(Math.pow(2, g)).fill(Number.MAX_VALUE);
        let r1;
        if ((g === 0 || k.slice(1).every(v => v === 0)) && k[0] !== -1) {
            r1 = md(cx, dx, ex)(zeta(-k[0]), ...new Array(Math.pow(2, g) - 1).fill(0));
        } else if (k[0] === -1) {
            r1 = md(cx, dx, ex)(0.577215664901532860606512090082402431042159335, 
                               ...new Array(Math.pow(2, g) - 1).fill(0));
        } else {
            r1 = new Array(Math.pow(2, g)).fill(0);
        }
        for (let a = 0; a <= l; a++) {
            if (a % 2 === 1 && a !== 1) {
                continue;
            }

            let d_temp = B[a] / factorial(a);
            d_temp = md1(cx, dx, ex)([d_temp, ...new Array(Math.pow(2, g) - 1).fill(0)], mp(cx, dx, ex)(n, [k[0] - a + 1, ...k.slice(1)]));
            if (a === 0 && k[0] === -1 && (g === 0 || k.slice(1).every(v => v === 0))) {
                if (n > 0) {
                    d_temp = [Math.log(n), ...new Array(Math.pow(2, g) - 1).fill(0)];
                } else if (n < -1) {
                    d_temp = [Number.NaN, ...new Array(Math.pow(2, g) - 1).fill(0)];
                } else if (n === -1) {
                    d_temp = [...new Array(Math.pow(2, g)).fill(0)];
                } else {
                    d_temp = [...new Array(Math.pow(2, g)).fill(0)];
                }
                r1 = r1.map((v, i) => v + d_temp[i]);
                continue;
            } else if (a > 0) {
                for (let b = 0; b < a - 1; b++) {
                    d_temp = md1(cx, dx, ex)(d_temp, [a + mod(k[0]) - (k[0] % 1 !== 0 ? 1 : 0) - b, 
                                           ...new Array(Math.pow(2, g) - 1).fill(0)]);
                    if (k[0] !== b) {
                        d_temp = md1(cx, dx, ex)(d_temp, [1, ...k.slice(1).map(v => v / (k[0] - b))]);
                    } else {
                        d_temp = md1(cx, dx, ex)(d_temp, [0, ...k.slice(1)]);
                    }
                }
            } else {
                d_temp = md2(cx, dx, ex)(d_temp, [mod(k[0]) - (k[0] % 1 !== 0 ? 1 : 0) + 1, 
                                        ...new Array(Math.pow(2, g) - 1).fill(0)]);
                if (k[0] !== -1) {
                    d_temp = md2(cx, dx, ex)(d_temp, [1, ...k.slice(1).map(v => v / (k[0] + 1))]);
                } else {
                    d_temp = md2(cx, dx, ex)(d_temp, [0, ...k.slice(1).map(v => v)]);
                }
            }
            if (a === 1) {
            } else if (Math.ceil(k[0]) - a > -1) {
                for (let c = 1; c < Math.ceil(k[0]) - a + 1; c++) {
                    d_temp = md1(cx, dx, ex)(d_temp, 
                        [(c + mod(k[0]) - (k[0] % 1 !== 0 ? 1 : 0) + a) / 
                         (c + mod(k[0]) - (k[0] % 1 !== 0 ? 1 : 0) + 1), 
                         ...new Array(Math.pow(2, g) - 1).fill(0)]);
                }
            } else {
                for (let c = Math.ceil(k[0]) - a + 1; c < 1; c++) {
                    if (c === -a && k[0] % 1 === 0) {
                        d_temp = md2(cx, dx, ex)(d_temp, [1 - a, ...new Array(Math.pow(2, g) - 1).fill(0)]);
                    } else if (c === -1 && k[0] % 1 === 0) {
                        d_temp = md1(cx, dx, ex)(d_temp, [a - 1, ...new Array(Math.pow(2, g) - 1).fill(0)]);
                    } else {
                        d_temp = md2(cx, dx, ex)(d_temp, 
                            [(c + mod(k[0]) - (k[0] % 1 !== 0 ? 1 : 0) + a) / 
                             (c + mod(k[0]) - (k[0] % 1 !== 0 ? 1 : 0) + 1), 
                             ...new Array(Math.pow(2, g) - 1).fill(0)]);
                    }
                }
            }
            if (d_temp.every((v, i) => Math.abs(v) >= Math.abs(d0[i])) && a > k[0]) {
                break;
            }
            r1 = r1.map((v, i) => v + d_temp[i]);
            d0 = d_temp;
        }
        if (n > 0 && n % 1 === 0) {
            for (let i = 1; i <= n; i++) {
                r2 = r2.map((v, j) => v + mp(cx, dx, ex)(i, k)[j]);
            }
        } else if (n % 1 === 0) {
            if (k[0] === 0 && (g === 0 || k.slice(1).every(v => v === 0))) {
                r2[0] -= 1;
            }
            for (let i = n + 1; i < 0; i++) {
                r2 = r2.map((v, j) => v - mp(cx, dx, ex)(i, k)[j]);
            }
        } else {
            r2 = null;
        }
        let output = `Approximation(By formula): ${r1}\n`;
        output += `Actual: ${r2}\n`;
        if (r2 !== null) {
            const error = r1.map((v, i) => v - r2[i]);
            output += `Error: ${error}`;
        }
        document.getElementById('output').textContent = output;
    } catch (error) {
        document.getElementById('output').textContent = error.message;
    }
}
